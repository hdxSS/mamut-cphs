(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,52683,e=>{"use strict";e.s(["default",()=>m],52683);var a=e.i(43476),t=e.i(71645);function s(e){var s;let{tabs:r}=e,[n,l]=(0,t.useState)((null==(s=r[0])?void 0:s.id)||"");return(0,a.jsxs)("div",{className:"w-full",children:[(0,a.jsx)("div",{className:"border-b border-gray-200",children:(0,a.jsx)("nav",{className:"flex -mb-px",children:r.map(e=>(0,a.jsx)("button",{onClick:()=>l(e.id),className:"\n                py-4 px-6 text-sm font-medium border-b-2 transition-colors\n                ".concat(n===e.id?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","\n              "),children:e.label},e.id))})}),(0,a.jsx)("div",{className:"py-6",children:r.map(e=>(0,a.jsx)("div",{className:n===e.id?"block":"hidden",children:e.component},e.id))})]})}let r="mamut_cphs_investigaciones",n="mamut_cphs_counter",l={generateId:()=>{let e=localStorage.getItem(n),a=(e?parseInt(e,10):0)+1;return localStorage.setItem(n,a.toString()),a.toString().padStart(6,"0")},save:function(e){let a=arguments.length>1&&void 0!==arguments[1]&&arguments[1],t=l.getAll();if(a){let a=t.findIndex(a=>a.id===e.id);-1!==a?t[a]=e:t.push(e)}else t.push(e);localStorage.setItem(r,JSON.stringify(t))},getAll:()=>{let e=localStorage.getItem(r);return e?JSON.parse(e):[]},search:(e,a)=>{let t=l.getAll(),s=e.toLowerCase().trim();return t.filter(e=>e[a].toLowerCase().includes(s))},getById:e=>l.getAll().find(a=>a.id===e),exportAllToCSV:()=>{let e=l.getAll();if(0===e.length)return"";let a=e.map(e=>{let a=e.acciones.map(e=>"[".concat(e.completada?"X":" ","] ").concat(e.descripcion," (").concat(e.fechaRecordatorio,")")).join(" | ");return[e.id,'"'.concat(e.nombre.replace(/"/g,'""'),'"'),e.edad,'"'.concat(e.area.replace(/"/g,'""'),'"'),e.antiguedad,e.fecha,'"'.concat(e.declaracionAccidente.replace(/"/g,'""'),'"'),'"'.concat(a.replace(/"/g,'""'),'"')].join(",")});return"".concat("ID,Nombre,Edad,Área,Antigüedad,Fecha,Declaración de Accidente,Acciones Correctivas","\n").concat(a.join("\n"))},downloadCSV:()=>{let e=new Blob([l.exportAllToCSV()],{type:"text/csv;charset=utf-8;"}),a=document.createElement("a"),t=URL.createObjectURL(e),s=new Date().toISOString().split("T")[0];a.setAttribute("href",t),a.setAttribute("download","mamut_cphs_database_".concat(s,".csv")),a.style.visibility="hidden",document.body.appendChild(a),a.click(),document.body.removeChild(a)},getPendingReminders:()=>{let e=l.getAll(),a=new Date;a.setHours(0,0,0,0);let t=new Date(a);t.setDate(t.getDate()+3);let s=[];return e.forEach(e=>{e.acciones.forEach(r=>{if(!r.completada){let n=new Date(r.fechaRecordatorio);n.setHours(0,0,0,0),n<=t&&n>=a&&s.push({investigacion:e,accion:r})}})}),s}};function c(e){let{isOpen:s,onClose:r,onSelect:n}=e,[c,i]=(0,t.useState)("nombre"),[d,o]=(0,t.useState)(""),[m,x]=(0,t.useState)([]);if(!s)return null;let u=()=>{d.trim()&&x(l.search(d,c))};return(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-2xl max-h-[80vh] overflow-auto",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsx)("h2",{className:"text-xl font-bold",children:"Consultar Folio"}),(0,a.jsx)("button",{onClick:r,className:"text-gray-500 hover:text-gray-700 text-2xl",children:"×"})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Buscar por:"}),(0,a.jsxs)("div",{className:"flex gap-4",children:[(0,a.jsxs)("label",{className:"flex items-center",children:[(0,a.jsx)("input",{type:"radio",value:"nombre",checked:"nombre"===c,onChange:e=>i(e.target.value),className:"mr-2"}),"Nombre"]}),(0,a.jsxs)("label",{className:"flex items-center",children:[(0,a.jsx)("input",{type:"radio",value:"id",checked:"id"===c,onChange:e=>i(e.target.value),className:"mr-2"}),"ID"]})]})]}),(0,a.jsx)("div",{children:(0,a.jsx)("input",{type:"text",value:d,onChange:e=>o(e.target.value),onKeyPress:e=>"Enter"===e.key&&u(),placeholder:"Buscar por ".concat(c,"..."),className:"w-full border border-gray-300 rounded px-3 py-2"})}),(0,a.jsx)("button",{onClick:u,className:"w-full bg-blue-600 text-white py-2 px-4 rounded hover:bg-blue-700",children:"Buscar"}),m.length>0&&(0,a.jsxs)("div",{className:"mt-4",children:[(0,a.jsxs)("h3",{className:"font-semibold mb-2",children:["Resultados (",m.length,"):"]}),(0,a.jsx)("div",{className:"space-y-2",children:m.map(e=>(0,a.jsxs)("div",{onClick:()=>{n(e),r(),o(""),x([])},className:"p-3 border border-gray-200 rounded hover:bg-gray-50 cursor-pointer",children:[(0,a.jsx)("div",{className:"font-semibold",children:e.nombre}),(0,a.jsxs)("div",{className:"text-sm text-gray-600",children:["ID: ",e.id]}),(0,a.jsxs)("div",{className:"text-sm text-gray-600",children:["Fecha: ",e.fecha]})]},e.id))})]}),d&&0===m.length&&(0,a.jsx)("div",{className:"text-center text-gray-500 py-4",children:"No se encontraron resultados"})]})]})})}function i(e){let{acciones:t,onChange:s}=e,r=(e,a,r)=>{s(t.map(t=>t.id===e?{...t,[a]:r}:t))};return(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold",children:"Acciones a Tomar"}),(0,a.jsxs)("button",{type:"button",onClick:()=>{s([...t,{id:"accion-".concat(Date.now(),"-").concat(Math.random().toString(36).substr(2,9)),descripcion:"",fechaRecordatorio:"",completada:!1}])},className:"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700 flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-xl",children:"+"}),"Agregar Acción"]})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[0===t.length&&(0,a.jsx)("p",{className:"text-gray-500 text-sm italic",children:"No hay acciones correctivas agregadas."}),t.map((e,n)=>(0,a.jsxs)("div",{className:"flex items-center gap-3 p-3 border border-gray-200 rounded bg-gray-50",children:[(0,a.jsx)("div",{className:"flex items-center",children:(0,a.jsx)("input",{type:"checkbox",checked:e.completada,onChange:a=>r(e.id,"completada",a.target.checked),className:"w-5 h-5 text-blue-600"})}),(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsx)("input",{type:"text",value:e.descripcion,onChange:a=>r(e.id,"descripcion",a.target.value),placeholder:"Descripción de la acción correctiva...",required:!e.completada,className:"w-full border border-gray-300 rounded px-3 py-2"})}),(0,a.jsx)("div",{children:(0,a.jsx)("input",{type:"date",value:e.fechaRecordatorio,onChange:a=>r(e.id,"fechaRecordatorio",a.target.value),required:!e.completada,className:"border border-gray-300 rounded px-3 py-2"})}),(0,a.jsx)("button",{type:"button",onClick:()=>{var a;return a=e.id,void s(t.filter(e=>e.id!==a))},className:"text-red-600 hover:text-red-800 font-bold text-xl px-2",title:"Eliminar acción",children:"×"})]},e.id))]})]})}function d(){let[e,s]=(0,t.useState)({id:"",nombre:"",edad:"",area:"",antiguedad:"",declaracionAccidente:"",fecha:new Date().toISOString().split("T")[0],acciones:[]}),[r,n]=(0,t.useState)(!1),[d,o]=(0,t.useState)(!1),[m,x]=(0,t.useState)(!1),[u,h]=(0,t.useState)(!1);(0,t.useEffect)(()=>{s(e=>({...e,id:l.generateId()}))},[]);let g=["Embalaje A","Vigilancia","Bodega de Despacho","Bodega de Granel","Mantención","Embalaje B","Galvanoplastía","Control de Calidad","Laminado","Cabeceado","RRHH","Reponedores","Vendedores Terreno","Atención clientes","Facturación","Admin 2ndo piso","Informática","Otros"],b=e=>{let{name:a,value:t}=e.target;"area"===a?(x("Otros"===t),"Otros"!==t?s(e=>({...e,[a]:t})):s(e=>({...e,[a]:""}))):s(e=>({...e,[a]:t}))};return(0,a.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[d&&(0,a.jsx)("div",{className:"mb-4 p-3 bg-green-100 text-green-700 rounded",children:"¡Investigación guardada exitosamente!"}),(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-bold",children:"Investigación"}),(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:["Folio: ",e.id]})]}),(0,a.jsx)("button",{type:"button",onClick:()=>n(!0),className:"bg-green-600 text-white py-2 px-4 rounded hover:bg-green-700",children:"Consultar Folio"})]}),(0,a.jsxs)("form",{onSubmit:a=>{a.preventDefault(),l.save(e,u),l.downloadCSV(),o(!0),setTimeout(()=>o(!1),3e3),s({id:l.generateId(),nombre:"",edad:"",area:"",antiguedad:"",declaracionAccidente:"",fecha:new Date().toISOString().split("T")[0],acciones:[]}),x(!1),h(!1)},className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Fecha *"}),(0,a.jsx)("input",{type:"date",name:"fecha",value:e.fecha,onChange:b,required:!0,className:"w-full border border-gray-300 rounded px-3 py-2"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Nombre *"}),(0,a.jsx)("input",{type:"text",name:"nombre",value:e.nombre,onChange:b,required:!0,className:"w-full border border-gray-300 rounded px-3 py-2"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Edad *"}),(0,a.jsx)("input",{type:"text",name:"edad",value:e.edad,onChange:b,required:!0,className:"w-full border border-gray-300 rounded px-3 py-2"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Área *"}),(0,a.jsxs)("select",{name:"area",value:m?"Otros":e.area,onChange:b,required:!m,className:"w-full border border-gray-300 rounded px-3 py-2 bg-white",children:[(0,a.jsx)("option",{value:"",children:"Seleccione un área..."}),g.map(e=>(0,a.jsx)("option",{value:e,children:e},e))]})]}),m?(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Especificar Área (Personal Externo) *"}),(0,a.jsx)("input",{type:"text",name:"area",value:e.area,onChange:b,required:!0,placeholder:"Ingrese el área o empresa externa...",className:"w-full border border-gray-300 rounded px-3 py-2"})]}):(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Antigüedad *"}),(0,a.jsx)("input",{type:"text",name:"antiguedad",value:e.antiguedad,onChange:b,required:!0,className:"w-full border border-gray-300 rounded px-3 py-2"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Declaración de Accidente *"}),(0,a.jsx)("textarea",{name:"declaracionAccidente",value:e.declaracionAccidente,onChange:b,required:!0,rows:6,className:"w-full border border-gray-300 rounded px-3 py-2"})]}),(0,a.jsx)(i,{acciones:e.acciones,onChange:e=>{s(a=>({...a,acciones:e}))}}),(0,a.jsx)("button",{type:"submit",className:"w-full bg-blue-600 text-white py-3 px-4 rounded hover:bg-blue-700 font-semibold",children:"Grabar"})]})]}),(0,a.jsx)(c,{isOpen:r,onClose:()=>n(!1),onSelect:e=>{s(e),h(!0),x(!g.filter(e=>"Otros"!==e).includes(e.area))}})]})}function o(e){let{onReminderClick:s}=e,[r,n]=(0,t.useState)([]),[c,i]=(0,t.useState)(!1);return(0,t.useEffect)(()=>{let e=()=>{n(l.getPendingReminders())};e();let a=setInterval(e,36e5);return()=>clearInterval(a)},[]),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsxs)("button",{type:"button",onClick:()=>i(!c),className:"relative p-2 text-white hover:bg-blue-700 rounded",children:[(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})}),r.length>0&&(0,a.jsx)("span",{className:"absolute top-0 right-0 inline-flex items-center justify-center px-2 py-1 text-xs font-bold leading-none text-white transform translate-x-1/2 -translate-y-1/2 bg-red-600 rounded-full",children:r.length})]}),c&&(0,a.jsxs)("div",{className:"absolute right-0 mt-2 w-96 bg-white rounded-lg shadow-xl border border-gray-200 z-50",children:[(0,a.jsx)("div",{className:"p-4 border-b border-gray-200",children:(0,a.jsx)("h3",{className:"font-semibold text-gray-900",children:"Recordatorios Pendientes"})}),(0,a.jsx)("div",{className:"max-h-96 overflow-y-auto",children:0===r.length?(0,a.jsx)("div",{className:"p-4 text-center text-gray-500",children:"No hay recordatorios pendientes"}):(0,a.jsx)("div",{className:"divide-y divide-gray-200",children:r.map(e=>{let{investigacion:t,accion:r}=e,n=(e=>{let a=new Date;a.setHours(0,0,0,0);let t=new Date(e);return t.setHours(0,0,0,0),Math.ceil((t.getTime()-a.getTime())/864e5)})(r.fechaRecordatorio);return(0,a.jsxs)("div",{onClick:()=>{i(!1),s&&s(t)},className:"p-4 hover:bg-gray-50 cursor-pointer",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,a.jsxs)("div",{className:"font-medium text-gray-900",children:["Folio: ",t.id]}),(0,a.jsx)("div",{className:"text-xs px-2 py-1 rounded ".concat(0===n?"bg-red-100 text-red-800":1===n?"bg-orange-100 text-orange-800":"bg-yellow-100 text-yellow-800"),children:0===n?"Hoy":1===n?"Mañana":"En ".concat(n," días")})]}),(0,a.jsx)("div",{className:"text-sm text-gray-600 mb-1",children:t.nombre}),(0,a.jsxs)("div",{className:"text-sm text-gray-900",children:["📋 ",r.descripcion]}),(0,a.jsxs)("div",{className:"text-xs text-gray-500 mt-1",children:["Fecha: ",r.fechaRecordatorio]})]},"".concat(t.id,"-").concat(r.id))})})})]})]})}function m(){(0,t.useRef)(null);let e=[{id:"investigaciones",label:"Investigaciones",component:(0,a.jsx)(d,{})}];return(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsx)("header",{className:"bg-blue-600 text-white shadow-lg",children:(0,a.jsxs)("div",{className:"container mx-auto px-4 py-4 flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold",children:"Mamut CPHS"}),(0,a.jsx)("p",{className:"text-sm text-blue-100",children:"Sistema de Gestión de Investigaciones"})]}),(0,a.jsx)(o,{})]})}),(0,a.jsx)("main",{className:"container mx-auto px-4 py-6",children:(0,a.jsx)(s,{tabs:e})})]})}}]);